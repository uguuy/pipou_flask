# mon_tp_flap

SELECT
  b.UTI_2001,
  CASE WHEN TO_CHAR(b.ISIN_2007) = TO_CHAR(n.ISIN_2007) THEN 'OK' ELSE 'DIFF' END AS ISIN_CMP,
  CASE WHEN TO_CHAR(b.EXECUTION_TS_2042) = TO_CHAR(n.EXECUTION_TS_2042) THEN 'OK' ELSE 'DIFF' END AS EXECUTION_TS_CMP,
  CASE WHEN TO_CHAR(b.PRICE_2048) = TO_CHAR(n.PRICE_2048) THEN 'OK' ELSE 'DIFF' END AS PRICE_CMP,
  CASE WHEN TO_CHAR(b.NOT_MNT_LEG1_2055) = TO_CHAR(n.NOT_MNT_LEG1_2055) THEN 'OK' ELSE 'DIFF' END AS NOTIONAL_LEG1_CMP,
  CASE WHEN TO_CHAR(b.NOT_MNT_LEG2_2064) = TO_CHAR(n.NOT_MNT_LEG2_2064) THEN 'OK' ELSE 'DIFF' END AS NOTIONAL_LEG2_CMP,
  CASE WHEN TO_CHAR(b.NOT_CCY_1_2056) = TO_CHAR(n.NOT_CCY_1_2056) THEN 'OK' ELSE 'DIFF' END AS NOT_CCY1_CMP,
  CASE WHEN TO_CHAR(b.NOT_CCY_2_2065) = TO_CHAR(n.NOT_CCY_2_2065) THEN 'OK' ELSE 'DIFF' END AS NOT_CCY2_CMP,
  CASE WHEN TO_CHAR(b.VENUE_EXECUTION_2041) = TO_CHAR(n.VENUE_EXECUTION_2041) THEN 'OK' ELSE 'DIFF' END AS VENUE_EXEC_CMP,
  CASE WHEN TO_CHAR(b.CONTRACT_TYPE_2010) = TO_CHAR(n.CONTRACT_TYPE_2010) THEN 'OK' ELSE 'DIFF' END AS CONTRACT_TYPE_CMP,
  CASE WHEN TO_CHAR(b.EXPIRATION_DAT_2044) = TO_CHAR(n.EXPIRATION_DAT_2044) THEN 'OK' ELSE 'DIFF' END AS EXPIRATION_DATE_CMP,
  CASE WHEN TO_CHAR(b.FINAL_CTR_STLMNT_DAT_2046) = TO_CHAR(n.FINAL_CTR_STLMNT_DAT_2046) THEN 'OK' ELSE 'DIFF' END AS FINAL_SETTLEMENT_CMP,
  CASE WHEN TO_CHAR(b.CLEARING_TS_2032) = TO_CHAR(n.CLEARING_TS_2032) THEN 'OK' ELSE 'DIFF' END AS CLEARING_TS_CMP,
  CASE WHEN TO_CHAR(b.UNDERLYING_IDENT_2014) = TO_CHAR(n.UNDERLYING_IDENT_2014) THEN 'OK' ELSE 'DIFF' END AS UNDERLYING_ID_CMP,
  CASE WHEN TO_CHAR(b.UNDERLYING_IDENT_TYPE_2013) = TO_CHAR(n.UNDERLYING_IDENT_TYPE_2013) THEN 'OK' ELSE 'DIFF' END AS UNDERLYING_ID_TYPE_CMP,
  CASE WHEN TO_CHAR(b.REPORTING_TS_1001) = TO_CHAR(n.REPORTING_TS_1001) THEN 'OK' ELSE 'DIFF' END AS REPORTING_TS_CMP,
  CASE WHEN TO_CHAR(b.REPORT_SUBMITTING_ENTITY_ID_1002) = TO_CHAR(n.REPORT_SUBMITTING_ENTITY_ID_1002) THEN 'OK' ELSE 'DIFF' END AS REPORT_ENTITY_CMP,
  CASE WHEN TO_CHAR(b.ASSET_CLASS_2011) = TO_CHAR(n.ASSET_CLASS_2011) THEN 'OK' ELSE 'DIFF' END AS ASSET_CLASS_CMP,
  CASE WHEN TO_CHAR(b.PRODUCT_CLASS_2009) = TO_CHAR(n.PRODUCT_CLASS_2009) THEN 'OK' ELSE 'DIFF' END AS PRODUCT_CLASS_CMP,
  CASE WHEN TO_CHAR(b.UPI_2008) = TO_CHAR(n.UPI_2008) THEN 'OK' ELSE 'DIFF' END AS UPI_CMP
FROM BASIC b
JOIN NASDAQ n
  ON b.UTI_2001 = n.UTI_2001
ORDER BY b.UTI_2001;
